/**
 * See https://www.ietf.org/timezones/data/leap-seconds.list.
 */

const UNIX_EPOCH_AS_NTP_TIMESTAMP = (70 * 365 + 17) * 86400;

const LEAP_SECOND_OFFSET = 10;

// TODO: better name?
const LEAP_SECOND_TIMESTAMPS = [
  2272060800 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +10 1 Jan 1972
  2287785600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +11 1 Jul 1972
  2303683200 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +12 1 Jan 1973
  2335219200 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +13 1 Jan 1974
  2366755200 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +14 1 Jan 1975
  2398291200 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +15 1 Jan 1976
  2429913600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +16 1 Jan 1977
  2461449600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +17 1 Jan 1978
  2492985600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +18 1 Jan 1979
  2524521600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +19 1 Jan 1980
  2571782400 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +20 1 Jul 1981
  2603318400 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +21 1 Jul 1982
  2634854400 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +22 1 Jul 1983
  2698012800 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +23 1 Jul 1985
  2776982400 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +24 1 Jan 1988
  2840140800 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +25 1 Jan 1990
  2871676800 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +26 1 Jan 1991
  2918937600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +27 1 Jul 1992
  2950473600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +28 1 Jul 1993
  2982009600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +29 1 Jul 1994
  3029443200 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +30 1 Jan 1996
  3076704000 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +31 1 Jul 1997
  3124137600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +32 1 Jan 1999
  3345062400 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +33 1 Jan 2006
  3439756800 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +34 1 Jan 2009
  3550089600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +35 1 Jul 2012
  3644697600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +36 1 Jul 2015
  3692217600 - UNIX_EPOCH_AS_NTP_TIMESTAMP, // +37 1 Jan 2017
];

// TODO: naming
export const addLeapSeconds = (timestamp: number) => {
  let leapSeconds = 0;
  for (
    let index = 0;
    LEAP_SECOND_TIMESTAMPS[index] >= timestamp &&
    index < LEAP_SECOND_TIMESTAMPS.length;
    index++
  ) {
    leapSeconds = LEAP_SECOND_OFFSET + index;
  }

  return timestamp + leapSeconds;
};
